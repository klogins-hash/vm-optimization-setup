#!/bin/bash
# VNC xstartup script with Mac keyboard support and clipboard integration

# Ensure we have a proper environment
unset SESSION_MANAGER
unset DBUS_SESSION_BUS_ADDRESS

# Load X resources
[ -r $HOME/.Xresources ] && xrdb $HOME/.Xresources

# Set background
xsetroot -solid grey

# Start clipboard manager for seamless copy/paste
autocutsel -fork &

# Start dbus session
eval $(dbus-launch --sh-syntax --exit-with-session)

# Apply Mac keyboard layout and shortcuts
sleep 2
xmodmap $HOME/.Xmodmap &
xbindkeys &

# Fix font rendering
export LANG=en_US.UTF-8

# Start XFCE4 session and keep it running
exec startxfce4
